generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("MYSQL_URL")
}

// Auth tables
model User {
  id                String    @id @db.VarChar(36)
  name              String    @db.VarChar(255)
  email             String    @unique @db.VarChar(255)
  emailVerified     Boolean   @default(false) @map("email_verified")
  image             String?   @db.Text
  createdAt         DateTime  @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt         DateTime  @updatedAt @map("updated_at") @db.Timestamp(3)
  role              String    @default("customer") @db.Text
  phoneNumber       String?   @map("phone_number") @db.Text

  sessions          Session[]
  accounts          Account[]
  inventoryTracking InventoryTracking[]

  @@map("user")
}

model Session {
  id        String   @id @db.VarChar(36)
  expiresAt DateTime @map("expires_at") @db.Timestamp(3)
  token     String   @unique @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)
  ipAddress String?  @map("ip_address") @db.Text
  userAgent String?  @map("user_agent") @db.Text
  userId    String   @map("user_id") @db.VarChar(36)

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "session_userId_idx")
  @@map("session")
}

model Account {
  id                    String    @id @db.VarChar(36)
  accountId             String    @map("account_id") @db.Text
  providerId            String    @map("provider_id") @db.Text
  userId                String    @map("user_id") @db.VarChar(36)
  accessToken           String?   @map("access_token") @db.Text
  refreshToken          String?   @map("refresh_token") @db.Text
  idToken               String?   @map("id_token") @db.Text
  accessTokenExpiresAt  DateTime? @map("access_token_expires_at") @db.Timestamp(3)
  refreshTokenExpiresAt DateTime? @map("refresh_token_expires_at") @db.Timestamp(3)
  scope                 String?   @db.Text
  password              String?   @db.Text
  createdAt             DateTime  @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt             DateTime  @updatedAt @map("updated_at") @db.Timestamp(3)

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "account_userId_idx")
  @@map("account")
}

model Verification {
  id         String   @id @db.VarChar(36)
  identifier String   @db.VarChar(255)
  value      String   @db.Text
  expiresAt  DateTime @map("expires_at") @db.Timestamp(3)
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt  DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  @@index([identifier], map: "verification_identifier_idx")
  @@map("verification")
}

// E-commerce tables

model Vendor {
  id        String   @id @db.VarChar(36)
  name      String   @db.VarChar(255)
  email     String?  @db.VarChar(255)
  phone     String?  @db.VarChar(50)
  website   String?  @db.VarChar(255)
  address   String?  @db.Text
  active    Boolean  @default(true)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  products Product[]

  @@index([name], map: "vendors_name_idx")
  @@map("vendors")
}

model ProductCategory {
  id          String   @id @db.VarChar(36)
  name        String   @db.VarChar(255)
  slug        String   @unique @db.VarChar(255)
  description String?  @db.Text
  image       String?  @db.Text
  parentId    String?  @map("parent_id") @db.VarChar(36)
  position    Int      @default(0)
  active      Boolean  @default(true)
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt   DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  parent   ProductCategory?  @relation("CategoryParent", fields: [parentId], references: [id])
  children ProductCategory[] @relation("CategoryParent")
  products Product[]

  @@index([parentId], map: "product_categories_parentId_idx")
  @@index([slug], map: "product_categories_slug_idx")
  @@map("product_categories")
}

model Definition {
  id        String   @id @db.VarChar(36)
  name      String   @db.VarChar(255)
  type      String   @db.VarChar(50)
  values    Json
  position  Int      @default(0)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  @@map("definitions")
}

model Product {
  id               String   @id @db.VarChar(36)
  name             String   @db.VarChar(255)
  slug             String   @unique @db.VarChar(255)
  description      String?  @db.Text
  sku              String?  @db.VarChar(100)
  price            Decimal  @db.Decimal(10, 2)
  compareAtPrice   Decimal? @map("compare_at_price") @db.Decimal(10, 2)
  cost             Decimal? @db.Decimal(10, 2)
  trackQuantity    Boolean  @default(true) @map("track_quantity")
  status           String   @default("draft") @db.VarChar(50)
  featured         Boolean  @default(false)
  vendorId         String?  @map("vendor_id") @db.VarChar(36)
  categoryId       String?  @map("category_id") @db.VarChar(36)
  material         String?  @db.Text
  weight           Decimal  @default(1) @db.Decimal(10, 2)
  weightUnit       String?  @default("kg") @map("weight_unit") @db.VarChar(10)
  requiresShipping Boolean  @default(true) @map("requires_shipping")
  taxIncluded      Boolean  @default(false) @map("tax_included")
  internalNote     String?  @map("internal_note") @db.Text
  createdAt        DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt        DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  category          ProductCategory?       @relation(fields: [categoryId], references: [id])
  vendor            Vendor?                @relation(fields: [vendorId], references: [id])
  variants          ProductVariant[]
  options           ProductOption[]
  metafields        ProductMetafield[]
  media             ProductMedia[]
  orderItems        OrderItem[]
  cartItems         CartItem[]
  tags              ProductTagsToProduct[]
  inventoryTracking InventoryTracking[]
  collectionProducts CollectionProduct[]

  @@index([slug], map: "products_slug_idx")
  @@index([status], map: "products_status_idx")
  @@index([categoryId], map: "products_categoryId_idx")
  @@index([vendorId], map: "products_vendorId_idx")
  @@map("products")
}

model ProductOption {
  id        String   @id @db.VarChar(36)
  productId String   @map("product_id") @db.VarChar(36)
  name      String   @db.VarChar(255)
  position  Int      @default(0)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  product        Product                @relation(fields: [productId], references: [id], onDelete: Cascade)
  values         ProductOptionValue[]
  variantOptions ProductVariantOption[]

  @@index([productId], map: "product_options_productId_idx")
  @@map("product_options")
}

model ProductOptionValue {
  id        String   @id @db.VarChar(36)
  optionId  String   @map("option_id") @db.VarChar(36)
  name      String   @db.VarChar(255)
  position  Int      @default(0)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  option         ProductOption          @relation(fields: [optionId], references: [id], onDelete: Cascade)
  variantOptions ProductVariantOption[]

  @@index([optionId], map: "product_option_values_optionId_idx")
  @@map("product_option_values")
}

model ProductVariant {
  id             String   @id @db.VarChar(36)
  productId      String   @map("product_id") @db.VarChar(36)
  sku            String?  @db.VarChar(100)
  barcode        String?  @db.VarChar(100)
  price          Decimal? @db.Decimal(10, 2)
  compareAtPrice Decimal? @map("compare_at_price") @db.Decimal(10, 2)
  cost           Decimal? @db.Decimal(10, 2)
  weight         Decimal? @db.Decimal(10, 2)
  position       Int      @default(0)
  isDefault      Boolean  @default(false) @map("is_default")
  createdAt      DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt      DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  product           Product                @relation(fields: [productId], references: [id], onDelete: Cascade)
  variantOptions    ProductVariantOption[]
  media             ProductVariantMedia[]
  inventory         Inventory?
  inventoryTracking InventoryTracking[]
  orderItems        OrderItem[]
  cartItems         CartItem[]

  @@index([productId], map: "product_variants_productId_idx")
  @@index([sku], map: "product_variants_sku_idx")
  @@map("product_variants")
}

model ProductVariantOption {
  id            String   @id @db.VarChar(36)
  variantId     String   @map("variant_id") @db.VarChar(36)
  optionId      String   @map("option_id") @db.VarChar(36)
  optionValueId String   @map("option_value_id") @db.VarChar(36)
  createdAt     DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt     DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  variant     ProductVariant     @relation(fields: [variantId], references: [id], onDelete: Cascade)
  option      ProductOption      @relation(fields: [optionId], references: [id], onDelete: Cascade)
  optionValue ProductOptionValue @relation(fields: [optionValueId], references: [id], onDelete: Cascade)

  @@index([variantId], map: "product_variant_options_variantId_idx")
  @@index([optionId], map: "product_variant_options_optionId_idx")
  @@index([optionValueId], map: "product_variant_options_optionValueId_idx")
  @@map("product_variant_options")
}

model Inventory {
  id        String   @id @db.VarChar(36)
  variantId String   @unique @map("variant_id") @db.VarChar(36)
  available Int      @default(0)
  reserved  Int      @default(0)
  onHand    Int      @default(0) @map("on_hand")
  committed Int      @default(0)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  variant ProductVariant @relation(fields: [variantId], references: [id], onDelete: Cascade)

  @@index([variantId], map: "inventory_variantId_idx")
  @@map("inventory")
}

model InventoryTracking {
  id                String   @id @db.VarChar(36)
  variantId         String   @map("variant_id") @db.VarChar(36)
  productId         String   @map("product_id") @db.VarChar(36)
  type              String   @db.VarChar(50)
  quantity          Int
  previousAvailable Int      @map("previous_available")
  previousReserved  Int      @map("previous_reserved")
  newAvailable      Int      @map("new_available")
  newReserved       Int      @map("new_reserved")
  reason            String?  @db.Text
  referenceType     String?  @map("reference_type") @db.VarChar(50)
  referenceId       String?  @map("reference_id") @db.VarChar(36)
  userId            String?  @map("user_id") @db.VarChar(36)
  createdAt         DateTime @default(now()) @map("created_at") @db.Timestamp(3)

  variant ProductVariant @relation(fields: [variantId], references: [id], onDelete: Cascade)
  product Product        @relation(fields: [productId], references: [id], onDelete: Cascade)
  user    User?          @relation(fields: [userId], references: [id], onDelete: SetNull)

  @@index([variantId], map: "inventory_tracking_variantId_idx")
  @@index([productId], map: "inventory_tracking_productId_idx")
  @@index([type], map: "inventory_tracking_type_idx")
  @@index([referenceType, referenceId], map: "inventory_tracking_referenceType_referenceId_idx")
  @@index([userId], map: "inventory_tracking_userId_idx")
  @@index([createdAt], map: "inventory_tracking_createdAt_idx")
  @@map("inventory_tracking")
}

model Media {
  id               String   @id @db.VarChar(36)
  filename         String   @db.VarChar(255)
  originalFilename String   @map("original_filename") @db.VarChar(255)
  mimeType         String   @map("mime_type") @db.VarChar(100)
  size             Int
  url              String   @db.Text
  alt              String?  @db.Text
  type             String   @db.VarChar(50)
  storage          String   @default("local") @db.VarChar(50)
  metadata         Json?
  createdAt        DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt        DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  productMedia        ProductMedia[]
  productVariantMedia ProductVariantMedia[]

  @@index([type], map: "media_type_idx")
  @@index([mimeType], map: "media_mimeType_idx")
  @@map("media")
}

model ProductTag {
  id        String   @id @db.VarChar(36)
  name      String   @db.VarChar(255)
  slug      String   @unique @db.VarChar(255)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  products ProductTagsToProduct[]

  @@index([slug], map: "product_tags_slug_idx")
  @@map("product_tags")
}

model ProductTagsToProduct {
  productId String @map("product_id") @db.VarChar(36)
  tagId     String @map("tag_id") @db.VarChar(36)

  product Product    @relation(fields: [productId], references: [id], onDelete: Cascade)
  tag     ProductTag @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([productId, tagId])
  @@index([productId], map: "product_tags_to_products_productId_idx")
  @@index([tagId], map: "product_tags_to_products_tagId_idx")
  @@map("product_tags_to_products")
}

model ProductMedia {
  id        String   @id @db.VarChar(36)
  productId String   @map("product_id") @db.VarChar(36)
  mediaId   String   @map("media_id") @db.VarChar(36)
  position  Int      @default(0)
  isPrimary Boolean  @default(false) @map("is_primary")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  media   Media   @relation(fields: [mediaId], references: [id], onDelete: Cascade)

  @@index([productId], map: "product_media_productId_idx")
  @@index([mediaId], map: "product_media_mediaId_idx")
  @@index([position], map: "product_media_position_idx")
  @@map("product_media")
}

model ProductVariantMedia {
  id        String   @id @db.VarChar(36)
  variantId String   @map("variant_id") @db.VarChar(36)
  mediaId   String   @map("media_id") @db.VarChar(36)
  position  Int      @default(0)
  isPrimary Boolean  @default(false) @map("is_primary")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  variant ProductVariant @relation(fields: [variantId], references: [id], onDelete: Cascade)
  media   Media          @relation(fields: [mediaId], references: [id], onDelete: Cascade)

  @@index([variantId], map: "product_variant_media_variantId_idx")
  @@index([mediaId], map: "product_variant_media_mediaId_idx")
  @@index([position], map: "product_variant_media_position_idx")
  @@map("product_variant_media")
}

model ProductMetafield {
  id        String   @id @db.VarChar(36)
  productId String   @map("product_id") @db.VarChar(36)
  namespace String   @db.VarChar(100)
  key       String   @db.VarChar(100)
  value     String?  @db.Text
  type      String   @db.VarChar(50)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([productId], map: "product_metafields_productId_idx")
  @@index([namespace, key], map: "product_metafields_namespace_key_idx")
  @@map("product_metafields")
}

model Customer {
  id               String   @id @db.VarChar(36)
  email            String   @unique @db.VarChar(255)
  firstName        String?  @map("first_name") @db.VarChar(255)
  lastName         String?  @map("last_name") @db.VarChar(255)
  phone            String?  @db.VarChar(50)
  acceptsMarketing Boolean  @default(false) @map("accepts_marketing")
  hasEmail         Boolean  @default(false) @map("has_email")
  totalSpent       Decimal  @default(0) @map("total_spent") @db.Decimal(10, 2)
  ordersCount      Int      @default(0) @map("orders_count")
  status           String   @default("active") @db.VarChar(50)
  createdAt        DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt        DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  orders     Order[]
  addresses  Address[]
  metafields CustomerMetafield[]
  carts      Cart[]

  @@index([email], map: "customers_email_idx")
  @@index([status], map: "customers_status_idx")
  @@map("customers")
}

model CustomerMetafield {
  id         String   @id @db.VarChar(36)
  customerId String   @map("customer_id") @db.VarChar(36)
  namespace  String   @db.VarChar(100)
  key        String   @db.VarChar(100)
  value      String?  @db.Text
  type       String   @db.VarChar(50)
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt  DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  customer Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)

  @@index([customerId], map: "customer_metafields_customerId_idx")
  @@index([namespace, key], map: "customer_metafields_namespace_key_idx")
  @@map("customer_metafields")
}

model Address {
  id         String   @id @db.VarChar(36)
  customerId String?  @map("customer_id") @db.VarChar(36)
  orderId    String?  @map("order_id") @db.VarChar(36)
  type       String   @db.VarChar(20)
  firstName  String?  @map("first_name") @db.VarChar(255)
  lastName   String?  @map("last_name") @db.VarChar(255)
  company    String?  @db.VarChar(255)
  address1   String   @db.VarChar(255)
  address2   String?  @db.VarChar(255)
  city       String   @db.VarChar(100)
  state      String?  @db.VarChar(100)
  zip        String?  @db.VarChar(20)
  country    String   @db.VarChar(100)
  phone      String?  @db.VarChar(50)
  isDefault  Boolean  @default(false) @map("is_default")
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt  DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  customer Customer? @relation(fields: [customerId], references: [id], onDelete: Cascade)
  order    Order?    @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([customerId], map: "addresses_customerId_idx")
  @@index([orderId], map: "addresses_orderId_idx")
  @@map("addresses")
}

model Order {
  id                String    @id @db.VarChar(36)
  orderNumber       String    @unique @map("order_number") @db.VarChar(50)
  customerId        String?   @map("customer_id") @db.VarChar(36)
  email             String?   @db.VarChar(255)
  status            String    @db.VarChar(50)
  financialStatus   String?   @map("financial_status") @db.VarChar(50)
  fulfillmentStatus String?   @map("fulfillment_status") @db.VarChar(50)
  subtotal          Decimal   @db.Decimal(10, 2)
  tax               Decimal   @default(0) @db.Decimal(10, 2)
  shipping          Decimal   @default(0) @db.Decimal(10, 2)
  discount          Decimal   @default(0) @db.Decimal(10, 2)
  total             Decimal   @db.Decimal(10, 2)
  currency          String    @default("BAM") @db.VarChar(3)
  note              String?   @db.Text
  cancelledAt       DateTime? @map("cancelled_at") @db.Timestamp(3)
  cancelledReason   String?   @map("cancelled_reason") @db.Text
  trackingNumber    String?   @map("tracking_number") @db.VarChar(255)
  createdAt         DateTime  @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt         DateTime  @updatedAt @map("updated_at") @db.Timestamp(3)

  customer   Customer?        @relation(fields: [customerId], references: [id], onDelete: SetNull)
  items      OrderItem[]
  metafields OrderMetafield[]
  addresses  Address[]

  @@index([orderNumber], map: "orders_orderNumber_idx")
  @@index([customerId], map: "orders_customerId_idx")
  @@index([status], map: "orders_status_idx")
  @@map("orders")
}

model OrderItem {
  id           String   @id @db.VarChar(36)
  orderId      String   @map("order_id") @db.VarChar(36)
  productId    String?  @map("product_id") @db.VarChar(36)
  variantId    String?  @map("variant_id") @db.VarChar(36)
  title        String   @db.VarChar(255)
  sku          String?  @db.VarChar(100)
  quantity     Int
  price        Decimal  @db.Decimal(10, 2)
  total        Decimal  @db.Decimal(10, 2)
  variantTitle String?  @map("variant_title") @db.VarChar(255)
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt    DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  order   Order           @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product Product?        @relation(fields: [productId], references: [id], onDelete: SetNull)
  variant ProductVariant? @relation(fields: [variantId], references: [id], onDelete: SetNull)

  @@index([orderId], map: "order_items_orderId_idx")
  @@index([productId], map: "order_items_productId_idx")
  @@index([variantId], map: "order_items_variantId_idx")
  @@map("order_items")
}

model OrderMetafield {
  id        String   @id @db.VarChar(36)
  orderId   String   @map("order_id") @db.VarChar(36)
  namespace String   @db.VarChar(100)
  key       String   @db.VarChar(100)
  value     String?  @db.Text
  type      String   @db.VarChar(50)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  order Order @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([orderId], map: "order_metafields_orderId_idx")
  @@index([namespace, key], map: "order_metafields_namespace_key_idx")
  @@map("order_metafields")
}

model Discount {
  id              String    @id @db.VarChar(36)
  code            String    @unique @db.VarChar(100)
  type            String    @db.VarChar(50)
  value           Decimal   @db.Decimal(10, 2)
  minimumPurchase Decimal?  @map("minimum_purchase") @db.Decimal(10, 2)
  maximumDiscount Decimal?  @map("maximum_discount") @db.Decimal(10, 2)
  usageLimit      Int?      @map("usage_limit")
  usageCount      Int       @default(0) @map("usage_count")
  startsAt        DateTime? @map("starts_at") @db.Timestamp(3)
  endsAt          DateTime? @map("ends_at") @db.Timestamp(3)
  active          Boolean   @default(true)
  createdAt       DateTime  @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt       DateTime  @updatedAt @map("updated_at") @db.Timestamp(3)

  carts Cart[]

  @@index([code], map: "discounts_code_idx")
  @@index([active], map: "discounts_active_idx")
  @@map("discounts")
}

model Cart {
  id         String    @id @db.VarChar(36)
  customerId String?   @map("customer_id") @db.VarChar(36)
  sessionId  String?   @map("session_id") @db.VarChar(255)
  discountId String?   @map("discount_id") @db.VarChar(36)
  expiresAt  DateTime? @map("expires_at") @db.Timestamp(3)
  createdAt  DateTime  @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt  DateTime  @updatedAt @map("updated_at") @db.Timestamp(3)

  customer Customer? @relation(fields: [customerId], references: [id], onDelete: Cascade)
  discount Discount? @relation(fields: [discountId], references: [id], onDelete: SetNull)
  items    CartItem[]

  @@index([customerId], map: "cart_customerId_idx")
  @@index([sessionId], map: "cart_sessionId_idx")
  @@map("cart")
}

model CartItem {
  id        String   @id @db.VarChar(36)
  cartId    String   @map("cart_id") @db.VarChar(36)
  productId String?  @map("product_id") @db.VarChar(36)
  variantId String?  @map("variant_id") @db.VarChar(36)
  quantity  Int
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  cart    Cart            @relation(fields: [cartId], references: [id], onDelete: Cascade)
  product Product?        @relation(fields: [productId], references: [id], onDelete: Cascade)
  variant ProductVariant? @relation(fields: [variantId], references: [id], onDelete: Cascade)

  @@index([cartId], map: "cart_items_cartId_idx")
  @@index([productId], map: "cart_items_productId_idx")
  @@index([variantId], map: "cart_items_variantId_idx")
  @@map("cart_items")
}

model ShippingMethod {
  id                 String   @id @db.VarChar(36)
  name               String   @db.VarChar(255)
  description        String?  @db.Text
  price              Decimal  @default(0) @db.Decimal(10, 2)
  isFreeShipping     Boolean  @default(false) @map("is_free_shipping")
  minimumOrderAmount Decimal? @map("minimum_order_amount") @db.Decimal(10, 2)
  active             Boolean  @default(true)
  position           Int      @default(0)
  createdAt          DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt          DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  @@index([name], map: "shipping_methods_name_idx")
  @@map("shipping_methods")
}

model PaymentMethod {
  id          String   @id @db.VarChar(36)
  name        String   @db.VarChar(255)
  description String?  @db.Text
  active      Boolean  @default(true)
  position    Int      @default(0)
  createdAt   DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt   DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  @@index([name], map: "payment_methods_name_idx")
  @@map("payment_methods")
}

model Setting {
  id        String   @id @db.VarChar(36)
  key       String   @unique @db.VarChar(255)
  value     String?  @db.Text
  type      String   @db.VarChar(50)
  group     String?  @db.VarChar(100)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  @@index([key], map: "settings_key_idx")
  @@map("settings")
}

model Page {
  id             String   @id @db.VarChar(36)
  title          String   @db.VarChar(255)
  slug           String   @unique @db.VarChar(255)
  content        String   @db.Text
  excerpt        String?  @db.Text
  status         String   @default("draft") @db.VarChar(50)
  template       String?  @db.VarChar(100)
  seoTitle       String?  @map("seo_title") @db.VarChar(255)
  seoDescription String?  @map("seo_description") @db.Text
  createdAt      DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt      DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  @@index([slug], map: "pages_slug_idx")
  @@index([status], map: "pages_status_idx")
  @@map("pages")
}

model Navigation {
  id        String   @id @db.VarChar(36)
  parentId  String?  @map("parent_id") @db.VarChar(36)
  title     String   @db.VarChar(255)
  url       String   @db.VarChar(500)
  icon      String?  @db.VarChar(100)
  image     String?  @db.VarChar(500)
  position  Int      @default(0)
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  parent   Navigation?  @relation("NavigationParent", fields: [parentId], references: [id], onDelete: Cascade)
  children Navigation[] @relation("NavigationParent")

  @@index([parentId], map: "navigation_parentId_idx")
  @@index([position], map: "navigation_position_idx")
  @@map("navigation")
}

model Collection {
  id                  String    @id @db.VarChar(36)
  name                String    @db.VarChar(255)
  slug                String    @unique @db.VarChar(255)
  description         String?   @db.Text
  image               String?   @db.Text
  ruleMatch           String    @default("all") @map("rule_match") @db.VarChar(10)
  sortOrder           String    @default("manual") @map("sort_order") @db.VarChar(50)
  active              Boolean   @default(true)
  seoTitle            String?   @map("seo_title") @db.VarChar(255)
  seoDescription      String?   @map("seo_description") @db.Text
  needsRegeneration   Boolean   @default(false) @map("needs_regeneration")
  lastRegeneratedAt   DateTime? @map("last_regenerated_at") @db.Timestamp(3)
  createdAt           DateTime  @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt           DateTime  @updatedAt @map("updated_at") @db.Timestamp(3)

  rules    CollectionRule[]
  products CollectionProduct[]

  @@index([slug], map: "collections_slug_idx")
  @@index([active], map: "collections_active_idx")
  @@index([needsRegeneration], map: "collections_needs_regeneration_idx")
  @@map("collections")
}

model CollectionRule {
  id           String   @id @db.VarChar(36)
  collectionId String   @map("collection_id") @db.VarChar(36)
  ruleType     String   @map("rule_type") @db.VarChar(50)
  operator     String   @db.VarChar(50)
  value        String   @db.Text
  position     Int      @default(0)
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt    DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  collection Collection @relation(fields: [collectionId], references: [id], onDelete: Cascade)

  @@index([collectionId], map: "collection_rules_collectionId_idx")
  @@index([ruleType], map: "collection_rules_ruleType_idx")
  @@map("collection_rules")
}

model CollectionProduct {
  id           String   @id @db.VarChar(36)
  collectionId String   @map("collection_id") @db.VarChar(36)
  productId    String   @map("product_id") @db.VarChar(36)
  position     Int      @default(0)
  isManual     Boolean  @default(false) @map("is_manual")
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamp(3)
  updatedAt    DateTime @updatedAt @map("updated_at") @db.Timestamp(3)

  collection Collection @relation(fields: [collectionId], references: [id], onDelete: Cascade)
  product    Product    @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([collectionId], map: "collection_products_collectionId_idx")
  @@index([productId], map: "collection_products_productId_idx")
  @@index([position], map: "collection_products_position_idx")
  @@map("collection_products")
}
